<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="684px" preserveAspectRatio="none" style="width:913px;height:684px;background:#FFFFFF;" version="1.1" viewBox="0 0 913 684" width="913px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="363" x="273.5" y="27.9951">Microcontroller certificate creation protocol</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="168" x2="168" y1="73.5938" y2="649.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="482" x2="482" y1="73.5938" y2="649.6484"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="762" x2="762" y1="73.5938" y2="649.6484"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="105" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="112" y="62.292">microcontroller</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="105" y="648.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="112" y="668.6436">microcontroller</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="441" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="448" y="62.292">organizer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="441" y="648.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="68" x="448" y="668.6436">organizer</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="733" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="740" y="62.292">server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="59" x="733" y="648.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45" x="740" y="668.6436">server</text><path d="M24,88.5938 L24,261.5938 L906,261.5938 L906,98.5938 L896,88.5938 L24,88.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M896,88.5938 L896,98.5938 L906,98.5938 L896,88.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="31" y="105.6606">Assumptions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304" x="31" y="120.7935">Microcontroller has the server's certificate (Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="7" x="335" y="124.501">S</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81" x="342" y="120.7935">) hardcoded.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="859" x="31" y="138.9263">The organizer and the microcontroller communicate over NFC. And the organizer and server communicate over a secure TLS channel.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="504" x="31" y="154.0591">In case the organizer has already assigned a microcontroller, then it can select</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="527" x="31" y="169.1919">this controller over their dashboard and create a new certificate for a given event.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="602" x="31" y="184.3247">Otherwise a new microcontroller can be added by creating a new unique microcontroller id (ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="633" y="188.0322">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="642" y="184.3247">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="31" y="202.4575">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408" x="31" y="217.5903">The certificate creation authorization (CCA) is signed and holds:</text><ellipse cx="36.5" cy="228.2891" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13" x="43" y="232.7231">ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="56" y="236.4307">E</text><ellipse cx="36.5" cy="246.4219" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13" x="43" y="250.856">ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="56" y="254.5635">M</text><polygon fill="#181818" points="750.5,287.0547,760.5,291.0547,750.5,295.0547,754.5,291.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="756.5" y1="291.0547" y2="291.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="489" y="282.9888">initialise microcontroller for event ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="720" y="286.6963">E</text><polygon fill="#181818" points="493,316.1875,483,320.1875,493,324.1875,489,320.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="487" x2="761.5" y1="320.1875" y2="320.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="499" y="315.1216">CCA</text><polygon fill="#181818" points="179,345.3203,169,349.3203,179,353.3203,175,349.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="173" x2="481" y1="349.3203" y2="349.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="185" y="344.2544">CCA</text><path d="M19,362.3203 L19,420.3203 L316,420.3203 L316,372.3203 L306,362.3203 L19,362.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M306,362.3203 L306,372.3203 L316,372.3203 L306,362.3203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="25" y="379.3872">Verify CCA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216" x="25" y="394.52">Generate public/private key for ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="241" y="398.2275">E</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41" x="251" y="394.52">and ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="292" y="398.2275">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="25" y="412.6528">Generate CSR (certificate signing request)</text><polygon fill="#181818" points="470,442.8516,480,446.8516,470,450.8516,474,446.8516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="168" x2="476" y1="446.8516" y2="446.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="175" y="441.7856">CSR</text><polygon fill="#181818" points="750.5,471.9844,760.5,475.9844,750.5,479.9844,754.5,475.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="482" x2="756.5" y1="475.9844" y2="475.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26" x="489" y="470.9185">CSR</text><path d="M668,488.9844 L668,531.9844 L857,531.9844 L857,498.9844 L847,488.9844 L668,488.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M847,488.9844 L847,498.9844 L857,498.9844 L847,488.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="674" y="506.0513">Verify CSR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="674" y="521.1841">Generate certificate Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="833" y="524.8916">M</text><polygon fill="#181818" points="493,557.3828,483,561.3828,493,565.3828,489,561.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="487" x2="761.5" y1="561.3828" y2="561.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="499" y="553.3169">Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="526" y="557.0244">M</text><polygon fill="#181818" points="179,589.5156,169,593.5156,179,597.5156,175,593.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="173" x2="481" y1="593.5156" y2="593.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="185" y="585.4497">Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="212" y="589.1572">M</text><path d="M118,606.5156 L118,634.5156 L217,634.5156 L217,616.5156 L207,606.5156 L118,606.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M207,606.5156 L207,616.5156 L217,616.5156 L207,606.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="124" y="623.5825">Verify Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="193" y="627.29">M</text><!--SRC=[RLDDRzim3BthL_2sP5YJxXe40OAi7GgiMx4KkyiI4nEr9K-IKwI_VfIiV5ZP9Ov4yl6zHyg_aUcaaosyI1T8KITDU95Qazd3r_jx8GA51k6PbBFAck1iqw03XPoz8oK3Wd8e0ra3dRE1aneXH7T1WxQebHvQDSgmRYyDVGmnFeo27jrXY0p_X32Mkqe6zLuigzNQ-xxj8WE_MCwhbIZ9rbmRQiprd_o8_MJ3XwNlgzLsEO-VAUSxhQn6FHElN7R5pkW4L2fIjcrxC-3PIFRdusO6wvmzhizoRaeaHrJl45v_R47LqXXiPkB9W98U2vmeI3PikpwoBvxs1ZK35BI-n2e351Z2C7g3AeXG4-k_K4-zEOySQEdhohBsn3DDbMq6W-yZmtOsajtJWR6HVy9C_680zqx-b7xZ3_UlEAZPKwYEUMDumuPqzk5lV-igQPWyVKkZUSwZ4MaW_rq-sOVQEleOJfFDPZq5bdeoXnNLjj5-8Jv31dqOG2yNkOj0Jeux9WHR3dUhqymMG8O2oIOgBTb6Mv8T9Rp8rNSC5F4MmDpEqAtA5scfqpJuSVn1HxjZkl-E1brKslLLGshUEJh4uniUKyznjoIqa7D6s6n_m-JQl6XE78D3zj-7wPLovfK9BsBTs8dXwi8uFymJQuwTUrwtEx-qMwDlFIfpHtwLmMlpE7uYKgJz0m00]--></g></svg>