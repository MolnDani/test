<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="652px" preserveAspectRatio="none" style="width:679px;height:652px;background:#FFFFFF;" version="1.1" viewBox="0 0 679 652" width="679px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="224" x="226" y="27.9951">Ticket verification protocol</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="174" x2="174" y1="73.5938" y2="617.0469"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="475" x2="475" y1="73.5938" y2="617.0469"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="147" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="154" y="62.292">client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="55" x="147" y="616.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="154" y="636.042">client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="412" y="42.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="419" y="62.292">microcontroller</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="412" y="616.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="419" y="636.042">microcontroller</text><path d="M5,88.5938 L5,397.5938 L645,397.5938 L645,98.5938 L635,88.5938 L5,88.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M635,88.5938 L635,98.5938 L645,98.5938 L635,88.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="102" x="11" y="105.6606">Assumptions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="11" y="120.7935">The server (S) holds a root certificate (Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="7" x="286" y="124.501">S</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="293" y="120.7935">) and the corresponding private and public key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="11" y="138.9263">(SK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="7" x="32" y="142.6338">S</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="43" y="138.9263">and PK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="7" x="87" y="142.6338">S</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="98" y="138.9263">respectively).</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="11" y="157.0591">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="302" x="11" y="172.1919">The microcontroller (M) holds a certificate (Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="313" y="175.8994">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308" x="322" y="172.1919">) signed by the root and the corresponding keys</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="11" y="190.3247">(SK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="32" y="194.0322">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="45" y="190.3247">and PK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="89" y="194.0322">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="98" y="190.3247">), the public key of the server.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="11" y="208.4575">Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="38" y="212.165">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="482" x="51" y="208.4575">also holds the the event's identifier for which the certificate was issued for.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391" x="11" y="226.5903">Also the microcontroller doesn't have an internet connection.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="11" y="241.7231">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415" x="11" y="256.856">The client (C) holds the ticket (T) digitally signed by the server (T</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="18" x="426" y="260.5635">tag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="448" y="256.856">= Enc(data, SK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="7" x="543" y="260.5635">S</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="14" x="550" y="256.856">)),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="11" y="274.9888">and the public key of the server.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="11" y="290.1216">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="11" y="305.2544">The data in the ticket (T</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="164" y="308.9619">data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332" x="189" y="305.2544">) signed by the server holds (at least) the following:</text><ellipse cx="16.5" cy="318.9531" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="23" y="323.3872">the client's unique identifier (ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="8" x="221" y="327.0947">C</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="229" y="323.3872">)</text><ellipse cx="16.5" cy="337.0859" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="23" y="341.52">the event's unique identifier (ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="224" y="345.2275">E</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="230" y="341.52">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="11" y="359.6528">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="532" x="11" y="374.7856">Furthermore let Enc(data, key) and Dec(data, key) denote a secure encryption and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="603" x="11" y="389.9185">decryption algorithm respectively. Let n denote a random nonce. Let + denote concatenation.</text><polygon fill="#181818" points="185.5,423.1172,175.5,427.1172,185.5,431.1172,181.5,427.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="179.5" x2="474" y1="427.1172" y2="427.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="191.5" y="419.0513">Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="218.5" y="422.7588">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="227.5" y="419.0513">, n</text><path d="M86,440.1172 L86,486.1172 L263,486.1172 L263,450.1172 L253,440.1172 L86,440.1172 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M253,440.1172 L253,450.1172 L263,450.1172 L253,440.1172 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="92" y="457.1841">Verify that Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="191" y="460.8916">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="204" y="457.1841">is valid</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="92" y="475.3169">A = Enc(T + n, PK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="205" y="479.0244">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="214" y="475.3169">)</text><polygon fill="#181818" points="463,508.5156,473,512.5156,463,516.5156,467,512.5156" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="174.5" x2="469" y1="512.5156" y2="512.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="181.5" y="507.4497">A</text><path d="M278,525.5156 L278,601.5156 L672,601.5156 L672,535.5156 L662,525.5156 L278,525.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M662,525.5156 L662,535.5156 L672,535.5156 L662,525.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="284" y="542.5825">T, n = Dec(A, SK</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="389" y="546.29">M</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="398" y="542.5825">)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272" x="284" y="560.7153">Verify that n is the nonce sent beforehand</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="284" y="575.8481">Verify that T is signed by the server</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="284" y="590.981">Verify that the ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="394" y="594.6885">E</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="404" y="590.981">in T</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="25" x="427" y="594.6885">data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="456" y="590.981">is equivalent to the ID</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="6" x="596" y="594.6885">E</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="606" y="590.981">in Cert</text><text fill="#000000" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="9" x="648" y="594.6885">M</text><!--SRC=[TLJ1Rjim3BthAtYhlQLfTmso047R0SDMe42DtHMPYONAaYl9AVBt8sKxiTtqKBWH-SZ7noU5DsqRwMKDBz97hNGZRNoHPQdj0NxStmiHTJG8XLPl6E68Nk-rab4x2urtqIbdX6WkM5168trawF-R16kjF45izCuOz9nLAo6iYmYIGY68zMwp3Q6j6-uHLkkxtKOK5K90JzqXUysXSgOC8C4xH_sGoYTE2Da3_LY7ThTvNT_n9mTfIuW4Lyvx38spQRB6woC3EDgqEwCLlE59PAz_nkWKVfaUSH5KKH_HdF8bYCHjFbRsV25vdT_pm2_eWyKITgV4CarqdJBn2sU2pvy93XKN2NiP2jm-dNJwBSMS0aWJNC-My_WFZxIucm2wf2-Hfv7spiD7fLNLKHiDzK5BrBGnceAIbcBBzU8LLKg7mTv4gEIHbGTj8tfBhg8Sovewk-pqx3sKFUHZOfq5ioA7KXzqbCQSPl8D7YdIW54U-X5_mfDLMIcZNC1qnNc-48FUNskMI36SE4-vf5eSkRxFdb0tH2OZ69GXvYcs9rNS1wrs9RvregQfIVRMwlSMn-fdlnzJfuU-JOyOzlGru6a0Y5-j9uYldKTY4KUAqC3TFNd4oH5LI_UIfb0jeT0gVqhNahD5YPUVvk2yZbKzkHvB-4jzxAME9vYhmJghi0j-7u9a0JQJbPqBaDZmkH2rWjlDO8WLpDsx0Dkz7evrxb-SV_nAyG98y4zsrm6EqkXIR7jR5CJ2BkRNQ4IXRtvBF8ZD2hQZZlHw5SI1Ih5usxEzpcN6N2mtvxqb1KXMghf3kZHOiQ3Zr89JhtbfaiN7qqMpGUUcv5ButjABPxXZT5_WvbAT9VWF]--></g></svg>